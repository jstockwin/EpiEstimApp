dist: trusty
language: r
sudo: false

env:
  global:
  - NOT_CRAN=true
  matrix:
  - browser=chrome platform=windows
  - browser=firefox platform=windows
  - browser=firefox platform=linux
  - browser=chrome platform=linux
  - browser=phantomjs platform=linux

cache:
  - packages
  
install:
  - Rscript -e "if (!require('pacman')) install.packages('pacman')"
  - Rscript -e "pacman::p_load('shiny', 'RSelenium', 'testthat', 'devtools', 'MCMCpack', 'shinyjs', 'ggplot2')"
  - Rscript -e "pacman::p_load('graphics', 'grid', 'gridExtra', 'plotly', 'plyr', 'reshape2', 'stats', 'future')"
  - Rscript -e "devtools::install_github('nickreich/coarseDataTools', ref = 'hackout3')"

before_script:
  - R -e "shiny::runApp(port=3000)" > out.txt 2>&1 &
  - sleep 10

script:
  - R -e "source('testUtils.R'); runTests(browsers='fromEnv', platforms='fromEnv')"
  
after_script:
  - cat out.txt

addons:
  sauce_connect:
    no_ssl_bump_domains: localhost

notifications:
  email: false
